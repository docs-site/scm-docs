import{_ as l,c as e,o as s,b0 as o,j as t,a as Q}from"./chunks/framework.C5ev1SXp.js";const r="/scm-docs/assets/image-20230507091629894-1758381904565-63.CDJ4S4RL.png",i="/scm-docs/assets/image-20230507092815618-1758381906843-65.Bu35sisn.png",n="/scm-docs/assets/image-20230507092947401-1758381908758-67.bnh0KhoP.png",p="/scm-docs/assets/image-20230506223648938-1758381910762-69.csfonl_I.png",d="/scm-docs/assets/image-20230506224304815-1758381912634-71.jGVuQLai.png",m="/scm-docs/assets/640-16834239033063-1758381914465-73.C-qvJ51C.png",T="/scm-docs/assets/640-168338423212829-1758381917049-75.C3mFB0Xl.png",h="/scm-docs/assets/640-168338428313732-1758381919863-77.Bjkrnt5j.png",c="/scm-docs/assets/image-20230506224739307-1758381922088-79.CTKn7ASH.png",u="/scm-docs/assets/image-20230506225837804-1758381923885-81.hYD6q0_3.png",g="/scm-docs/assets/image-20230506230231423-1758381925702-83.BTutB-V4.png",_="/scm-docs/assets/image-20230507072251388-1758381928525-85.Duw3nlzO.png",q="/scm-docs/assets/image-20230507093548660-1758381930844-87.DmN1csKm.png",V="/scm-docs/assets/image-20230507093731364-1758381933028-89.BqVtcETf.png",O="/scm-docs/assets/image-20230507094215240-1758381935246-91.UQrl77yh.png",P="/scm-docs/assets/image-20230507080917821-1758381937548-93.B6NMAl4u.png",S="/scm-docs/assets/image-20230507094312028-1758381939754-95.Dv5SY9Lj.png",H="/scm-docs/assets/image-20230507094617810-1758381941841-97.C3qj-PGO.png",M="/scm-docs/assets/image-20230507102337204-1758381944385-99.COEEvIJ1.png",b="/scm-docs/assets/image-20230507102552748-1758381946305-101.Bm5hLxvC.png",f="/scm-docs/assets/image-20230507102836902-1758381948256-103.SGBU62tF.png",L="/scm-docs/assets/640-16834267671886-1758381950591-105.D2JN60m0.png",k="/scm-docs/assets/640-16834268681729-1758381953682-107.CCFtouKZ.png",x="/scm-docs/assets/640-168342694901912-1758381955749-109.CF6F1FnE.png",y="/scm-docs/assets/640-168342702272815-1758381957806-111.DZJgJ6MY.png",I="/scm-docs/assets/640-168342709066918-1758381959551-113.B2FSxO1l.png",A=JSON.parse('{"title":"LV010-输入输出模式详解","description":null,"frontmatter":{"title":"LV010-输入输出模式详解","date":"2025-09-20T22:39:55.000Z","icon":"famicons:logo-markdown","permalink":"/sdoc/peripheral/gpio/126b08e804d303ad5b541ecd","index":true,"tags":null,"categories":null,"copyright":false,"keywords":null,"cover":null,"comments":null,"mathjax":null,"top":null,"description":null,"tdoc":{"detailDate":"2025-09-20T22:39:55.058Z","fulluuid":"d5b541ecde0f4e1799e17d09e88a33fa","useduuid":"d5b541ecd"}},"headers":[],"relativePath":"sdoc/peripheral/gpio/126b08e804d303ad5b541ecd.md","filePath":"sdoc/20-基本外设篇/01-GPIO/LV010-输入输出模式详解.md","lastUpdated":1758153691000}'),w={name:"sdoc/peripheral/gpio/126b08e804d303ad5b541ecd.md"},Z={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.912ex"},xmlns:"http://www.w3.org/2000/svg",width:"24.003ex",height:"2.896ex",role:"img",focusable:"false",viewBox:"0 -877 10609.1 1279.9","aria-hidden":"true"};function N(D,a,G,U,z,v){return s(),e("div",null,[a[4]||(a[4]=o('<h1 id="lv010-输入输出模式详解" tabindex="-1">LV010-输入输出模式详解 <a class="header-anchor" href="#lv010-输入输出模式详解" aria-label="Permalink to &quot;LV010-输入输出模式详解&quot;">​</a></h1><p>这篇笔记主要是详细学习一下GPIO输入输出各种模式（推挽、开漏、准双向端口）。</p><h2 id="一、概述" tabindex="-1">一、概述 <a class="header-anchor" href="#一、概述" aria-label="Permalink to &quot;一、概述&quot;">​</a></h2><h3 id="_1-io模式说明" tabindex="-1">1. IO模式说明 <a class="header-anchor" href="#_1-io模式说明" aria-label="Permalink to &quot;1. IO模式说明&quot;">​</a></h3><p>概括地说，IO的功能模式大致可以分为输入、输出以及输入输出双向三大类。其中作为基本输入IO，相对比较简单，主要涉及的知识点就是高阻态；作为输出IO，相比于输入复杂一些，工作模式主要有开漏（Open Drain）模式和推挽（Push-Pull）模式，这一部分涉及的知识点比较多；对于输入输出IO，容易产生疑惑的地方是准双向和双向端口的区别。</p><h3 id="_2-mos管基础" tabindex="-1">2. MOS管基础 <a class="header-anchor" href="#_2-mos管基础" aria-label="Permalink to &quot;2. MOS管基础&quot;">​</a></h3><p>这里学习一下P-MOS和N-MOS导通的条件，前面后边都给我整糊涂了，这里记录一下，如下图为P-MOS和N-MOS导通时的电流流向：</p><img src="'+r+'" alt="image-20230507091629894" style="zoom:80%;"><p>NMOS管的主回路电流方向为D→S，要求VGS&gt;0，即VG-VS&gt;0, 至于VG-VS到底等于多少才能保证MOS管导通，则需要查询MOS管的手册根据参数VGth而定，一般为5~10V（G电位比S电位高）；</p><p>PMOS管的主回路电流方向为S→D，要求 VGS&lt;0，即VG-VS&lt;0, 至于VG-VS到底等于多少才能保证MOS管导通，则需要查询MOS管的手册根据参数VGth而定，一般为-5~-10V（S电位比G电位高），下面以导通压差6V为例。</p><p>【注意】这里的导通条件是没问题的，但是对于去分析STM32的GPIO的时候就会让人很迷，也许是因为STM32的GPIO框图中有一个我们看不见的输出控制电路吧，反正大概懂原理就是了。</p><ul><li>N-MOS</li></ul><p>使用NMOS当下管，S极直接接地（为固定值），只需将G极电压固定值6V即可导通；若使用NMOS当上管，D极接正电源，而S极的电压不固定，无法确定控制NMOS导通的G极电压，因为S极对地的电压有两种状态，MOS管截止时为低电平，导通时接近高电平VCC。当然NMOS也是可以当上管的，只是控制电路复杂，这种情况必须使用隔离电源控制，使用一个PMOS管就能解决的事情一般不会这么干，明显增加电路难度。</p><img src="'+i+'" alt="image-20230507092815618" style="zoom:67%;"><ul><li>P-MOS</li></ul><p>使用PMOS当上管，S极直接接电源VCC，S极电压固定，只需G极电压比S极低6V即可导通，使用方便；同理若使用PMOS当下管，D极接地，S极的电压不固定（0V或VCC），无法确定控制极G极的电压，使用较麻烦，需采用隔离电压设计。</p><img src="'+n+'" alt="image-20230507092947401" style="zoom:67%;"><h2 id="二、输入io" tabindex="-1">二、输入IO <a class="header-anchor" href="#二、输入io" aria-label="Permalink to &quot;二、输入IO&quot;">​</a></h2><p>这里所说的输入IO，指的是只作为输入，不具有输出功能。此时对于input引脚的要求就是高阻（高阻与三态是同一个概念）。基本输入电路的类型大致可以分为3类：基本输入IO电路、施密特触发输入电路以及弱上拉输入电路。</p><h3 id="_1-最基本的输入io" tabindex="-1">1. 最基本的输入IO <a class="header-anchor" href="#_1-最基本的输入io" aria-label="Permalink to &quot;1. 最基本的输入IO&quot;">​</a></h3><img src="'+p+'" alt="image-20230506223648938" style="zoom:50%;"><p>其中的缓冲器U1是具有控制输入端，且具有高阻抗特性的三态缓冲器。通俗地说就是这个缓冲器对外来说是高阻的，相当于在控制输入端不使能的情况下，物理引脚与内部总线之间是完全隔离的，完全不会影响内部电路。而控制输入端的作用就是可以发出读Pin状态的操作指令。其过程如下图所示。</p><img src="'+d+'" alt="image-20230506224304815" style="zoom:67%;"><h3 id="_2-抖动" tabindex="-1">2. 抖动？ <a class="header-anchor" href="#_2-抖动" aria-label="Permalink to &quot;2. 抖动？&quot;">​</a></h3><p>这种基本电路的一个缺点是在读取外部信号的跳变沿时会出现抖动，如下图所示：</p><img src="'+m+'" alt="图片" style="zoom:67%;"><p>于是施密特触发输入电路就是解决了上述这种抖动的问题，其经过施密特触发器后的信号下图所示。</p><img src="'+T+'" alt="图片" style="zoom:77%;"><h3 id="_3-电平检测问题" tabindex="-1">3. 电平检测问题 <a class="header-anchor" href="#_3-电平检测问题" aria-label="Permalink to &quot;3. 电平检测问题&quot;">​</a></h3><p>对于输入电路还存在另外一个问题，就是当输入引脚悬空的时候，输入端检测到的电平是高还是低？当输入信号没有被驱动，即悬空（Floating）时，输入引脚上任何的噪声都会改变输入端检测到的电平，如下图所示。</p><img src="'+h+'" alt="图片" style="zoom:80%;"><p>为了解决这个问题，可以在输入引脚处加一个弱上拉电阻，如下图所示。</p><img src="'+c+'" alt="image-20230506224739307" style="zoom:50%;"><p>这样，当输入引脚悬空时，会被 R1上拉到高电平，在内部总线上就有确定的状态了。但是这种结构是有一定问题的。首先很明显的一点是，当输入引脚悬空时读到的是 1，当输入引脚被高电平驱动时读到的也是1，只有当输入引脚被低电平驱动时读到的才是0。也就是对于读 1采取的方式是&quot;读取非零&quot;的方式。另一个问题是该电路对外呈现的不是高阻，某种意义上说也在向外输出，当外部驱动电路不同时可能出现错误的检测结果。例如外部驱动电路是如下图所示的结构，该电路结构中通过K打到不同端可以输出高电平或者低电平。</p><img src="'+u+'" alt="image-20230506225837804" style="zoom:50%;"><p>如果将上图所示的电路输出低电平，连接到带有弱上拉电阻的输入引脚，其结构如下所示。</p><img src="'+g+'" alt="image-20230506230231423" style="zoom:50%;">',37)),t("p",null,[a[2]||(a[2]=Q("由欧姆定律知，测试点处的电平是",-1)),t("mjx-container",Z,[(s(),e("svg",C,[...a[0]||(a[0]=[o('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(1491.2,0)"><path data-c="2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z" style="stroke-width:3;"></path></g><g data-mml-node="mfrac" transform="translate(2213.4,0)"><g data-mml-node="mrow" transform="translate(1162.9,394) scale(0.707)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1500,0)"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mrow" transform="translate(220,-345) scale(0.707)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1000,0)"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(1889,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(2667,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)" style="stroke-width:3;"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(4167,0)"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z" style="stroke-width:3;"></path></g></g><rect width="3775.1" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(6506.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(7562.1,0)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" style="stroke-width:3;"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)" style="stroke-width:3;"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(778,0)" style="stroke-width:3;"></path><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" transform="translate(1278,0)" style="stroke-width:3;"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(1778,0)" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(9840.1,0)"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z" style="stroke-width:3;"></path></g></g></g>',1)])])),a[1]||(a[1]=t("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[t("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[t("mn",null,"5"),t("mi",null,"V"),t("mo",null,"∗"),t("mfrac",null,[t("mrow",null,[t("mn",null,"100"),t("mi",null,"K")]),t("mrow",null,[t("mn",null,"10"),t("mi",null,"K"),t("mo",null,"+"),t("mn",null,"100"),t("mi",null,"K")])]),t("mo",null,"="),t("mn",null,"4.545"),t("mi",null,"V")])],-1))]),a[3]||(a[3]=Q("于是CPU测得的输入信号为高，而外部驱动电路希望输出的电平为低。这种错误的原因就在于这种结构的输入电路并不是真正的高阻，或者说这个输入IO其实也在输出，而且影响了外部输入电路。",-1))]),a[5]||(a[5]=o('<h3 id="_4-高阻" tabindex="-1">4. 高阻 <a class="header-anchor" href="#_4-高阻" aria-label="Permalink to &quot;4. 高阻&quot;">​</a></h3><p>这种情况的发生也说明了：信号前后两级传递，为什么需要输出阻抗小，输入阻抗大的原因。在这个例子中，外围驱动电路的输出阻抗很大，达到了100Kohm；而输入端的阻抗又不够大，只有10Kohm，于是就出现了问题。如果输入端的输入阻抗真正做到高阻（无穷大），如下所示，就不会出现问题。</p><img src="'+_+'" alt="image-20230507072251388" style="zoom:50%;"><p>上面提到的这个带弱上拉的输入电路，也就是在后续会提到的准双向端口的情况。</p><h2 id="三、输出io" tabindex="-1">三、输出IO <a class="header-anchor" href="#三、输出io" aria-label="Permalink to &quot;三、输出IO&quot;">​</a></h2><p>IO输出电路最主要的两种模式分别是推挽输出（Push-Pull Output）和开漏输出（Open Drain Output）。</p><h3 id="_1-推挽输出-push-pull-output" tabindex="-1">1. 推挽输出(Push-Pull Output) <a class="header-anchor" href="#_1-推挽输出-push-pull-output" aria-label="Permalink to &quot;1. 推挽输出(Push-Pull Output)&quot;">​</a></h3><p>推挽输出的结构是由两个三极管或者MOS管受到互补信号的控制，两个管子始终保持一个处于截止，另一个处于导通的状态，这里以上一节STM32的GPIO中的推挽输出结构为例：</p><img src="'+q+'" alt="image-20230507093548660" style="zoom:50%;"><p>推挽输出的最大特点是可以真正能真正的输出高电平和低电平，在两种电平下都具有驱动能力。</p><blockquote><p>所谓的驱动能力，就是指输出电流的能力。对于驱动大负载（即负载内阻越小，负载越大）时，例如IO输出为5V，驱动的负载内阻为10ohm，于是根据欧姆定律可以正常情况下负载上的电流为0.5A（推算出功率为2.5W）。显然一般的IO不可能有这么大的驱动能力，也就是没有办法输出这么大的电流。于是造成的结果就是输出电压会被拉下来，达不到标称的5V。</p></blockquote><p>当然如果只是数字信号的传递，下一级的输入阻抗理论上最好是高阻，也就是只需要传电压，基本没有电流，也就没有功率，于是就不需要很大的驱动能力。</p><p>对于推挽输出，输出高、低电平时电流的流向如下图所示。所以相比于后面介绍的开漏输出，输出高电平时的驱动能力强很多。</p><img src="'+V+'" alt="image-20230507093731364" style="zoom:50%;"><p>但推挽输出的一个缺点是，如果当两个推挽输出结构相连在一起，推挽输出结构1输出高电平，即上面的MOS导通，下面的MOS闭合时；同时推挽输出结构2输出低电平，即上面的MOS闭合，下面的MOS导通时。电流会从推挽输出结构1的VCC通过上端MOS再经过推挽输出结构2下端MOS直接流向VSS。整个通路上电阻很小，会发生短路，进而可能造成端口的损害。这也是为什么推挽输出不能实现&quot; 线与&quot;的原因。</p><img src="'+O+'" alt="image-20230507094215240" style="zoom:50%;"><h3 id="_2-开漏输出-open-drain-output" tabindex="-1">2. 开漏输出(Open Drain Output) <a class="header-anchor" href="#_2-开漏输出-open-drain-output" aria-label="Permalink to &quot;2. 开漏输出(Open Drain Output)&quot;">​</a></h3><h4 id="_2-1-基本电路" tabindex="-1">2.1 基本电路 <a class="header-anchor" href="#_2-1-基本电路" aria-label="Permalink to &quot;2.1 基本电路&quot;">​</a></h4><p>常说的与推挽输出相对的就是开漏输出，对于开漏输出和推挽输出的区别最普遍的说法就是开漏输出无法真正输出高电平，即高电平时没有驱动能力，需要借助外部上拉电阻完成对外驱动。下面就从内部结构和原理上说明为什么开漏输出输出高电平时没有驱动能力，以及进一步比较与推挽输出的区别。</p><p>首先需要介绍一些开漏输出和开集输出。这两种输出的原理和特性基本是类似的，区别在于一个是使用MOS管，其中的&quot;漏&quot;指的就是MOS管的漏极；另一个使用三极管，其中的&quot;集&quot;指的就是MOS三极管的集电极。</p><p>这两者其实都是和推挽输出相对应的输出模式，由于使用MOS管的情况较多，很多时候就用&quot;开漏输出&quot;这个词代替了开漏输出和开集输出。</p><img src="'+P+'" alt="image-20230507080917821" style="zoom:50%;"><p>图左边的电路是开集（OC）输出最基本的电路，当输入为高电平时，NPN三极管导通，Output被拉到GND，输出为低电平；当输入为低电平时，NPN三极管闭合，Output相当于开路（输出高阻）。高电平时输出高阻（高阻、三态以及floating说的都是一个意思），此时对外没有任何的驱动能力。</p><p>这就是开漏和开集输出最大的特点，如何利用该特点完成各种功能稍后再说。这个电路虽然完成了开集输出的功能，但是会出现input为高，输出为低；input为低，输出为高的情况。</p><p>图右边的电路中多使用了一个三极管完成了&quot;反相&quot;。当输入为高电平时，第一个三极管导通，此时第二个三极管的输入端会被拉到GND，于是第二个三极管闭合，输出高阻；当输入为低电平时，第一个三极管闭合，此时第二个三极管的输入端会被上拉电阻拉到高电平，于是第二个三极管导通，输出被拉到GND。这样，这个电路的输入与输出是同相的了。</p><p>接下来我们来看开漏输出的电路，如下图所示。原理与开集输出基本相同，只是将三极管换成了MOS而已：</p><img src="'+S+'" alt="image-20230507094312028" style="zoom:50%;"><h4 id="_2-2-应用" tabindex="-1">2.2 应用 <a class="header-anchor" href="#_2-2-应用" aria-label="Permalink to &quot;2.2 应用&quot;">​</a></h4><p>接着说说开漏、开集输出的特点以及应用，由于两者相似，后边若无特殊说明，则用开漏表示开漏和开集输出电路。</p><ul><li>开漏输出最主要的特性就是高电平没有驱动能力，需要借助外部上拉电阻才能真正输出高电平，其电路如下图所示。</li></ul><img src="'+H+'" alt="image-20230507094617810" style="zoom:67%;"><p>当MOS管闭合时，开漏输出电路输出高电平，且连接着负载时，电流流向是从外部电源，流经上来电阻R1，流进负载，最后进入VSS（一般是公共接地端）。</p><p>（1）开漏输出的这一特性一个明显的优势就是可以很方便的调节输出的电平，因为输出电平完全由上拉电阻连接的电源电平决定。所以在需要进行电平转换的地方，非常适合使用开漏输出。</p><p>（2）开漏输出的这一特性另一个好处在于可以实现&quot;线与&quot;功能，所谓的&quot;线与&quot;指的是多个信号线直接连接在一起，只有当所有信号全部为高电平时，合在一起的总线为高电平；只要有任意一个或者多个信号为低电平，则总线为低电平。而推挽输出就不行，如果高电平和低电平连在一起，会出现电流倒灌，损坏器件。</p><h3 id="_3-推挽与开漏对比" tabindex="-1">3. 推挽与开漏对比 <a class="header-anchor" href="#_3-推挽与开漏对比" aria-label="Permalink to &quot;3. 推挽与开漏对比&quot;">​</a></h3><table tabindex="0"><thead><tr><th>比较项</th><th>推挽输出</th><th>开漏输出</th></tr></thead><tbody><tr><td>高电平驱动能力</td><td>强</td><td>由外部上拉电阻提供</td></tr><tr><td>低电平驱动能力</td><td>强</td><td>强</td></tr><tr><td>电平跳变速度</td><td>快</td><td>由外部上拉电阻决定，电阻越小反应越快，功耗越大</td></tr><tr><td>线与功能</td><td>不支持</td><td>支持</td></tr><tr><td>电平转换</td><td>不支持</td><td>支持</td></tr></tbody></table><h2 id="三、双向io" tabindex="-1">三、双向IO <a class="header-anchor" href="#三、双向io" aria-label="Permalink to &quot;三、双向IO&quot;">​</a></h2><h3 id="_1-基本电路" tabindex="-1">1. 基本电路 <a class="header-anchor" href="#_1-基本电路" aria-label="Permalink to &quot;1. 基本电路&quot;">​</a></h3><p>很多处理器的引脚可以设置为双向端口，双向端口的要求就是既可以输出信号，又可以读回外部信号输入。要同时做到这两点从原理上来说有点困难，首先从处理器的开漏输出IO口的内部结构说起，如下图所示。</p><img src="'+M+'" alt="image-20230507102337204" style="zoom:50%;"><p>在N-MOS之前加入了一个FF（U2），目的是用于控制输出信号的时间。比较常见的一个应用场合是多个IO作为一个总线时，需要总线上的各个引脚同时将数据输出。对于开漏输出结构，会将FF（U2）的输出Q端连接会输入驱动缓冲器，这样的话执行读操作是读的并不是外部引脚的状态，而是自己输出的状态。</p><h3 id="_2-双向开漏io" tabindex="-1">2.  双向开漏IO <a class="header-anchor" href="#_2-双向开漏io" aria-label="Permalink to &quot;2.  双向开漏IO&quot;">​</a></h3><p>对上边双向IO的基本电路进行修改：</p><img src="'+b+'" alt="image-20230507102552748" style="zoom:50%;"><p>该结构称为双向开漏IO的结构。所做的改动是将输入驱动缓冲器连接到了PIN上。该结构输出为&quot;1&quot;（Q=1）时，N-MOS断开，此时pin对外呈现高阻，作为输入引脚没有任何问题。但是如果该结构输出&quot;0&quot;（Q=0）时，N-MOS导通，此时pin对外短路到地，即无论外部输入什么信号，U1读回的全部是低。所以对于这样的结构，如果需要作为输入引脚使用时，必须给U2输出&quot;1&quot;后才能读取外部引脚数据。</p><h3 id="_3-准双向开漏io" tabindex="-1">3. 准双向开漏IO <a class="header-anchor" href="#_3-准双向开漏io" aria-label="Permalink to &quot;3. 准双向开漏IO&quot;">​</a></h3><p>准双向端口就是双向IO电路的的结构中加了一个上拉电阻，如下图所示：</p><img src="'+f+'" alt="image-20230507102836902" style="zoom:50%;"><p>（1）作为输入引脚使用时，也必须先向U2中写&quot;1&quot;，以达到断开N-MOS的目的。所以是否需要提前写&quot;1&quot;并不是双向IO与准双向IO的区别。两者做输入端口时都需要提前写&quot;1&quot;。</p><p>（2）双向端口作为输入时是真正的高阻态，而准双向IO作为输入端口时，输入阻抗不为高阻，于是有可能出现《一》中第三小节的3. 电平检测问题。</p><p>（3）准双向端口读取输入状态，默认为高。也就是判断外部输入信号的方法是&quot;非低则为高&quot;。即该结构只能准确的识别外部的低电平，无法区分悬空和真正的高。于是只要读到的不是0，都认为外部为1。</p><h3 id="_4-推挽输出作为双向io" tabindex="-1">4. 推挽输出作为双向IO <a class="header-anchor" href="#_4-推挽输出作为双向io" aria-label="Permalink to &quot;4. 推挽输出作为双向IO&quot;">​</a></h3><p>如果双向端口中的输出部分采用的是推挽输出结构，那么作为输入时必须将上下两个管子全部端口才能成为高阻，作为输入。</p><h2 id="四、51单片机" tabindex="-1">四、51单片机？ <a class="header-anchor" href="#四、51单片机" aria-label="Permalink to &quot;四、51单片机？&quot;">​</a></h2><h3 id="_1-p0口有哪东西" tabindex="-1">1. P0口有哪东西？ <a class="header-anchor" href="#_1-p0口有哪东西" aria-label="Permalink to &quot;1. P0口有哪东西？&quot;">​</a></h3><p>在双向端口的讨论中，比较复杂的就是51单片机的P0端口了。P0端口的内部结构如图所示。</p><img src="'+L+'" alt="图片" style="zoom:80%;"><p>内部结构比较复杂，包括以下这些器件：</p><p>（1）U1：与门。一个输入连着控制线，另一个输入连接这地址/数据信号。由于与门的特性，当控制线为1时，与门输出与地址/数据信号的电平保持一致；如果控制线为0，则输出恒为。于是控制信号线相当于与门的使能信号。</p><p>（2）U2：反相器，输出信号为地址/数据信号的反相信号。</p><p>（3）U3和U6都是具有控制输入端且具有高阻抗特性的三态缓冲器，作用是对于外部呈现高阻态。当控制端使能时可以将外部信号的电平读进数据总线。</p><p>（4）U4：为锁存器，目的就是控制引脚输出信号的时间。</p><p>（5）U5：模拟开关，可以控制V2的输入信号是来自锁存器U4的Q非输出还是来自于反相器U2的输出。</p><p>（6） V1和V2分别是两个MOS管。</p><h3 id="_2-p0用于地址-数据线时" tabindex="-1">2. P0用于地址/数据线时 <a class="header-anchor" href="#_2-p0用于地址-数据线时" aria-label="Permalink to &quot;2. P0用于地址/数据线时&quot;">​</a></h3><p>在P0作为地址/数据线时，是地址、数据复用总线，P0需要输出地址，同时需要读回数据信号。当P0需要输出地址信息时，U1的控制信号为0，模拟开关U5接到U2反相器的输出。于是当地址信号线传来的信号为1，与控制线&quot;1&quot;相与之后输出到V1的输入信号为&quot;1&quot;，V1截止。地址信号&quot;1&quot;经反相之后，通过模拟开关输出到V2的输入端为&quot;0&quot;，V2导通，于是情况如下图所示，pin输出&quot;0&quot;。</p><p><img src="'+k+'" alt="图片"></p><p>当地址信号线传来的信号为1，与控制线&quot;1&quot;相与之后输出到V1的输入信号为&quot;0&quot;，V1导通。地址信号&quot;0&quot;经反相之后，通过模拟开关输出到V2的输入端为&quot;1&quot;，V2截止，于是情况如图所示，pin输出&quot;1&quot;。</p><p><img src="'+x+'" alt="图片"></p><p>于是在作为地址线输出时，V1、V2两个MOS管均使用了，是推挽输出。当P0在输出低8位地址信息后，将变为数据总线，此时CPU的操作是控制端输出0，模拟开关打到锁存器的Q非端，且向锁存器中打入&quot;1&quot;。于是Q非输出为0，V2截止。同时控制线为0使得与门输出为0，V1截止。由于V1和V2都截止，所以此时pin对外完全呈现高阻，作为输入端口，外部数据通过U6进入内部总线，情况如下图所示。（相当于将推挽输出的两个MOS管全部断开了）此时由于对外呈现高阻，所以是真正的输入引脚。这就解释了为什么说P0是真正的双线端口。</p><p><img src="'+y+'" alt="图片"></p><h3 id="_3-p0用于普通io时" tabindex="-1">3. P0用于普通IO时 <a class="header-anchor" href="#_3-p0用于普通io时" aria-label="Permalink to &quot;3. P0用于普通IO时&quot;">​</a></h3><p>在P0作为普通IO并作为输出时，控制信号为0，使V1始终处于截止状态。模拟开关连接到Q非输出，当作为输出时，锁存器的输入端直接输入0或者1，Q非将反相信号输入到V2的输入端。即当输出&quot;0&quot;时，V2输入端为&quot;1&quot;，V2导通，pin输出&quot;0&quot;；当输出&quot;1&quot;时，V2输入端为&quot;0&quot;，V2截止，pin输出高阻的0。即当P0工作在普通IO模式下，输出为开漏输出，且内部没有上拉电阻。</p><p>在P0作为普通IO并作为输入时，控制信号为0，使V1始终处于截止状态。模拟开关连接到Q非输出，且CPU自动向锁存器输入端写1，则V2输入端为0，V2截止。与之前在作为地址/数据线，作为输入时一样，也是两个MOS管全部断开，pin直接连接到U6，对外呈现高阻。于是也是真正的输入引脚。</p><p>综上P0无论工作在哪种模式下都是真正的双端口IO。</p><h3 id="_4-p1-p3端口" tabindex="-1">4. P1～P3端口 <a class="header-anchor" href="#_4-p1-p3端口" aria-label="Permalink to &quot;4. P1～P3端口&quot;">​</a></h3><p>51单片机的其他三个端口的内部结构如下所示，与P0相比简单了很多，没有了顶部的MOS管，也没有了地址/数据信号的选项。作为输出时是带有上拉电阻的的开漏输出，作为输入时是有上拉电阻存在的，于是输入端口对外不是高阻。这就解释了为什么P1～P3只能是准双向端口。</p><p><img src="'+I+'" alt="图片"></p>',78))])}const E=l(w,[["render",N]]);export{A as __pageData,E as default};
