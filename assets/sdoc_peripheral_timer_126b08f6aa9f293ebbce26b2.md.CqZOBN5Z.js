import{_ as e,c as t,o as s,b0 as i}from"./chunks/framework.C5ev1SXp.js";const o="/scm-docs/assets/image-20240114094348633.DNudQJci.png",r="/scm-docs/assets/image-20240114094505479.DXtaXiZ7.png",l="/scm-docs/assets/image-20240114094533282.C4kGGTSy.png",c="/scm-docs/assets/image-20240114094657690.BqTZX4_q.png",m="/scm-docs/assets/image-20240114094809695.CedvJuqc.png",n="/scm-docs/assets/image-20240114094844460.C8iyUV-0.png",_="/scm-docs/assets/image-20240114094924856.DnmIlMe5.png",b=JSON.parse('{"title":"LV035-通用定时器的中断","description":null,"frontmatter":{"title":"LV035-通用定时器的中断","date":"2025-09-21T18:39:03.000Z","icon":"famicons:logo-markdown","permalink":"/sdoc/peripheral/timer/126b08f6aa9f293ebbce26b2","index":true,"tags":null,"categories":null,"copyright":false,"keywords":null,"cover":null,"comments":null,"mathjax":null,"top":null,"description":null,"tdoc":{"detailDate":"2025-09-21T18:39:03.659Z","fulluuid":"ebbce26b2eed4f0e8e7db13c33566c30","useduuid":"ebbce26b2"}},"headers":[],"relativePath":"sdoc/peripheral/timer/126b08f6aa9f293ebbce26b2.md","filePath":"sdoc/20-基本外设篇/15-定时器/LV035-通用定时器的中断.md","lastUpdated":1758153691000}'),p={name:"sdoc/peripheral/timer/126b08f6aa9f293ebbce26b2.md"};function d(T,a,M,I,h,x){return s(),t("div",null,[...a[0]||(a[0]=[i('<h1 id="lv035-通用定时器的中断" tabindex="-1">LV035-通用定时器的中断 <a class="header-anchor" href="#lv035-通用定时器的中断" aria-label="Permalink to &quot;LV035-通用定时器的中断&quot;">​</a></h1><h2 id="一、相关寄存器" tabindex="-1">一、相关寄存器 <a class="header-anchor" href="#一、相关寄存器" aria-label="Permalink to &quot;一、相关寄存器&quot;">​</a></h2><p>我们来学习使用通用定时器中断，学习 TIM2/TIM3/TIM4/TIM5 的几个与定时器中断相关且重要的寄存器。主要以定时器3为例。</p><h3 id="_1-控制寄存器-1-timx-cr1" tabindex="-1">1. 控制寄存器 1（TIMx_CR1） <a class="header-anchor" href="#_1-控制寄存器-1-timx-cr1" aria-label="Permalink to &quot;1. 控制寄存器 1（TIMx_CR1）&quot;">​</a></h3><p>TIM2/TIM3/TIM4/TIM5 的控制寄存器 1 描述如图：</p><img src="'+o+'" alt="image-20240114094348633" style="zoom:50%;"><p>上图中只截出了中断需要用的一些位，其中：</p><p>位 7（APRE）用于控制自动重载寄存器是否进行缓冲，如果 ARPE 位置 1， ARR 起缓冲作用，即只有在更新事件发生时才会把 ARR的值写入其影子寄存器里；如果 ARPE 位置 0，那么修改自动重载寄存器的值时，该值会马上被写入其影子寄存器中，从而立即生效。</p><p>CMS[1:0]位，用于设置边沿对齐模式还是中心对齐模式，本实验我们使用边沿对齐模式，所以设置为 00 即可。</p><p>DIR 位，用于控制定时器的计数方向，我们使用递增计数模式，所以设置 DIR 位为 0。</p><p>CEN 位，用于使能计数器的工作，必须要设置该位为 1，计数器才会开始计数。</p><h3 id="_2-从模式控制寄存器-timx-smcr" tabindex="-1">2. 从模式控制寄存器（TIMx_SMCR） <a class="header-anchor" href="#_2-从模式控制寄存器-timx-smcr" aria-label="Permalink to &quot;2. 从模式控制寄存器（TIMx_SMCR）&quot;">​</a></h3><p>TIM2/TIM3/TIM4/TIM5 的从模式控制寄存器描述如图：</p><img src="'+r+'" alt="image-20240114094505479" style="zoom:50%;"><p>该寄存器的 SMS[2:0]位，用于从模式选择，其实就是选择计数器输入时钟的来源。比如通用定时器中断实验我们设置 SMS[2:0]=000，禁止从模式，这样 PSC 预分频器的时钟就直接来自内部时钟（CK_INT）， 按照我们例程 sys_stm32_clock_init 函数的配置， 频率为 72Mhz（APB1总线时钟频率的 2 倍）。</p><h3 id="_3-dma-中断使能寄存器-timx-dier" tabindex="-1">3. DMA/中断使能寄存器（TIMx_DIER） <a class="header-anchor" href="#_3-dma-中断使能寄存器-timx-dier" aria-label="Permalink to &quot;3. DMA/中断使能寄存器（TIMx_DIER）&quot;">​</a></h3><p>TIM2/TIM3/TIM4/TIM5 的 DMA/中断使能寄存器描述如图 ：</p><img src="'+l+'" alt="image-20240114094533282" style="zoom:50%;"><p>该寄存器用于使能/失能触发 DMA 请求、捕获/比较中断以及更新中断。中断实验更新中断，所以把位 0（UIE）置 1 即可。</p><h3 id="_4-状态寄存器-timx-sr" tabindex="-1">4. 状态寄存器（TIMx_SR） <a class="header-anchor" href="#_4-状态寄存器-timx-sr" aria-label="Permalink to &quot;4. 状态寄存器（TIMx_SR）&quot;">​</a></h3><p>TIM2/TIM3/TIM4/TIM5 的状态寄存器描述如图:</p><img src="'+c+'" alt="image-20240114094657690" style="zoom:50%;"><p>该寄存器都是一些中断标志位，比如更新中断标志位、 捕获/比较中断标志位等。在通用定时器中断实验我们用到更新中断标志位，当定时器更新中断到来后，位 0（UIF）会由硬件置 1，我们需要在中断服务函数里面把该位清零。</p><h3 id="_5-计数寄存器-timx-cnt" tabindex="-1">5. 计数寄存器（TIMx_CNT） <a class="header-anchor" href="#_5-计数寄存器-timx-cnt" aria-label="Permalink to &quot;5. 计数寄存器（TIMx_CNT）&quot;">​</a></h3><p>TIM2/TIM3/TIM4/TIM5 的计数器寄存器描述如图：</p><img src="'+m+'" alt="image-20240114094809695" style="zoom:50%;"><p>TIM2/TIM3/TIM4/TIM5 的计数寄存器都是 16 位有效的， 计数模式可以是递增计数模式、递减计数模式和中心对齐计数模式，计数值范围 0~65535。 可以直接写该寄存器设置计数的初始值，也可以读取该寄存器获取计数器值。</p><h3 id="_6-预分频寄存器-timx-psc" tabindex="-1">6. 预分频寄存器（TIMx_PSC） <a class="header-anchor" href="#_6-预分频寄存器-timx-psc" aria-label="Permalink to &quot;6. 预分频寄存器（TIMx_PSC）&quot;">​</a></h3><p>TIM2/TIM3/TIM4/TIM5 的预分频器寄存器描述如图：</p><img src="'+n+'" alt="image-20240114094844460" style="zoom:50%;"><p>定时器的预分频寄存器都是 16 位的，即写入该寄存器的数值范围是 0 到 65535，表示 1 到65536 分频。比如我们要 7200 分频，就往该寄存器写入 7199。</p><h3 id="_7-自动重载寄存器-timx-arr" tabindex="-1">7. 自动重载寄存器（TIMx_ARR） <a class="header-anchor" href="#_7-自动重载寄存器-timx-arr" aria-label="Permalink to &quot;7. 自动重载寄存器（TIMx_ARR）&quot;">​</a></h3><p>TIM2/TIM3/TIM4/TIM5 的自动重载寄存器描述如图：</p><img src="'+_+'" alt="image-20240114094924856" style="zoom:50%;"><p>自动重载寄存器是低 16 位有效。该寄存器可以由 APRE 位设置是否进行缓冲。计数器的值会和自动重装寄存器影子寄存器进行比较，当两者相等，定时器就会溢出，从而发生更新事件，如果打开了更新中断，还会发生更新中断。</p>',35)])])}const g=e(p,[["render",d]]);export{b as __pageData,g as default};
